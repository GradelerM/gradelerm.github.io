<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Serveurs cartographiques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../static/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cours" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cours</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cours">    
        <li>
    <a class="dropdown-item" href="../../cours/geonum/introduction.html">
 <span class="dropdown-text">GeoNum</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../cours/geonum/serveurs_carto.html">Serveurs cartographiques</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/serveurs_carto.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Serveurs cartographiques</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/archi_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Architecture web</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectifs" id="toc-objectifs" class="nav-link active" data-scroll-target="#objectifs">Objectifs</a></li>
  <li><a href="#cours" id="toc-cours" class="nav-link" data-scroll-target="#cours">Cours</a></li>
  <li><a href="#tp---prise-en-main-de-geoserver" id="toc-tp---prise-en-main-de-geoserver" class="nav-link" data-scroll-target="#tp---prise-en-main-de-geoserver">️TP - Prise en main de GeoServer</a>
  <ul class="collapse">
  <li><a href="#déploiement-de-geoserver-à-laide-de-docker" id="toc-déploiement-de-geoserver-à-laide-de-docker" class="nav-link" data-scroll-target="#déploiement-de-geoserver-à-laide-de-docker">Déploiement de GeoServer à l’aide de Docker</a></li>
  <li><a href="#espaces-de-travail-entrepôts-et-couches" id="toc-espaces-de-travail-entrepôts-et-couches" class="nav-link" data-scroll-target="#espaces-de-travail-entrepôts-et-couches">Espaces de travail, Entrepôts et Couches</a></li>
  <li><a href="#styliser-mes-couches" id="toc-styliser-mes-couches" class="nav-link" data-scroll-target="#styliser-mes-couches">Styliser mes couches</a></li>
  <li><a href="#lire-mes-flux-dans-une-autre-application" id="toc-lire-mes-flux-dans-une-autre-application" class="nav-link" data-scroll-target="#lire-mes-flux-dans-une-autre-application">Lire mes flux dans une autre application</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusion(s)</a></li>
  <li><a href="#tp---qgis-server-avec-lizmap" id="toc-tp---qgis-server-avec-lizmap" class="nav-link" data-scroll-target="#tp---qgis-server-avec-lizmap">TP - QGIS Server avec LizMap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Serveurs cartographiques</h1>
<p class="subtitle lead">Introduction aux serveurs cartographiques et à l’utilisation de GeoServer.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectifs" class="level2">
<h2 class="anchored" data-anchor-id="objectifs">Objectifs</h2>
<ul>
<li><p>Comprendre ce qu’est un serveur cartographique et ce que sont les flux WMS, WFS, etc.</p></li>
<li><p>Connaître les principaux serveurs cartographiques avec un focus sur GeoServer, un serveur cartographique Open-Source.</p></li>
<li><p>Apprendre à déployer une instance de GeoServer à l’aide de Docker.</p></li>
<li><p>Publier des couches avec GeoServer et les styliser en passant par QGIS.</p></li>
<li><p>Lire les flux WMS de mon GeoServer dans une application OpenLayers basique.</p></li>
<li><p>Être capable de déterminer dans quelles situations on a besoin d’un serveur cartographique.</p></li>
</ul>
</section>
<section id="cours" class="level2">
<h2 class="anchored" data-anchor-id="cours">Cours</h2>
<p><a href="../../cours/geonum/slides_serveurs_carto.html" target="_blank">Slides&nbsp;: Serveurs Cartographiques</a></p>
</section>
<section id="tp---prise-en-main-de-geoserver" class="level2">
<h2 class="anchored" data-anchor-id="tp---prise-en-main-de-geoserver">️TP - Prise en main de GeoServer</h2>
<section id="déploiement-de-geoserver-à-laide-de-docker" class="level3">
<h3 class="anchored" data-anchor-id="déploiement-de-geoserver-à-laide-de-docker">Déploiement de GeoServer à l’aide de Docker</h3>
<p><a href="https://docs.geoserver.org/main/en/user/installation/docker.html">Documentation GeoServer</a> - <a href="https://github.com/geoserver/docker">Dépôt de l’image Docker</a></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ce TP suppose que Docker est installé sur la machine. Il a été écrit pour une machine Linux, certains chemins et lignes de commande peuvent donc être différents sur une machine Windows ou Mac.</p>
</div>
</div>
<p>Une fois que Docker est installé, lancez la commande suivante pour télécharger une image de GeoServer en version 2.26.0&nbsp;:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull docker.osgeo.org/geoserver:2.26.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Puis, pour construire un container à partir de l’image de GeoServer&nbsp;:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-it</span> <span class="at">-p</span> 80:8080 docker.osgeo.org/geoserver:2.26.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Si vous n’avez pas eu de message d’erreur, rendez-vous sur <a href="http://localhost/geoserver" class="uri">http://localhost/geoserver</a> et connectez-vous avec l’identifiant <code>admin</code> et le mot de passe <code>geoserver</code>. Si l’authentification a fonctionné, félicitations, vous avez réussi à faire tourner un container avec GeoServer&nbsp;!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attends, attends… des containers, des images&nbsp;? Hein&nbsp;?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExN2xjZWIxY3gxeXZlZXdqeGZ1b3d6ZDRoaWQ3amtjMmd1dmcxdGVndSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/WRQBXSCnEFJIuxktnw/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Confused math"></p>
</figure>
</div>
<p>Pas de panique&nbsp;! On n’a pas besoin de savoir exactement comment fonctionne Docker pour ce TP. Si on veut simplifier&nbsp;:</p>
<ul>
<li><p>Docker permet de faire tourner des <strong>services</strong> dans des <strong>containers</strong> créés à partir d’<strong>images</strong>.</p></li>
<li><p>Une <strong>image</strong> est une recette à suivre pour créer mon container. Elle demande à Docker de créer un container basé sur Debian, d’y installer GeoServer ou bien une base PostgreSQL avec l’extension postGIS, etc.</p></li>
<li><p>Un <strong>container</strong> est le produit d’une image. C’est un peu le plat cuisiné à partir de la recette. C’est à l’intérieur du container que tourne mon <strong>service</strong> comme ma base de données ou mon serveur web. On peut connecter plusieurs containers entre eux, pratique si on veut un site web et une base de données qui fonctionnent ensemble&nbsp;!</p></li>
<li><p>Un <strong>service</strong> est généralement une base de données (ex. PostgreSQL), un serveur de site web (ex. Apache), un serveur cartographique (ex. GeoServer), etc. Comme les bonnes pratiques demandent d’avoir un seul service par container, on va parler du “container GeoServer” pour dire “le container qui contient mon service GeoServer”, ça va plus vite.</p></li>
</ul>
<p>Si ce n’est encore pas clair et que ça vous gêne pour la compréhension de la suite du TP, hop, on lève la main et on demande des explications, je suis là pour ça&nbsp;! Et si vous voulez aller plus loin, rendez-vous sur la <a href="https://docs.docker.com/">documentation officelle de Docker</a>.</p>
</div>
</div>
</div>
<p>Pour vérifier que tout fonctionne, on va faire une petite manip rapide.</p>
<ul>
<li>En haut à droite de l’écran, si ce n’est pas déjà le cas, sélectionnez le langage “fr” pour passer l’interface en français.</li>
<li>Allez dans “Espaces de travail” (menu à gauche de l’écran) et cliquez sur le bouton “Ajouter un nouvel espace de travail”.</li>
<li>Appelez-le “mon_espace” et donnez lui un URI <code>mon_espace</code>.</li>
<li>Vérfiez qu’il apparaît bien dans la liste de vos espaces (normalement, au-dessus de “ne”).</li>
</ul>
<p>Ensuite, on va arrêter notre container Docker. Commencez par utiliser la commande suivante&nbsp;:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Vous devriez voir apparaître une ligne avec l’ID de votre container dans la colonne CONTAINER ID, l’image utilisée pour le construire dans la colonne IMAGE, d’autres informations qui ne nous servent pas dans ce TP et son nom dans la colonne NAME. La commande <code>docker ps</code> permet de lister les containers actifs en ce moment. On souhaite arrêter notre container avec la commande <code>docker stop &lt;container_name&gt;</code>. Pour cela, il faut utiliser le nom du container à la place de <code>&lt;container_name&gt;</code>. Par exemple, voici les informations de mon container&nbsp;:</p>
<pre><code>CONTAINER ID   IMAGE                               COMMAND                  CREATED         STATUS                            PORTS                                     NAMES
0a885cadf11d   docker.osgeo.org/geoserver:2.26.0   "bash /opt/startup.sh"   8 seconds ago   Up 7 seconds (health: starting)   0.0.0.0:80-&gt;8080/tcp, [::]:80-&gt;8080/tcp   charming_pare</code></pre>
<p>Le nom de mon container est donc <code>charming_pare</code>. Pour arrêter mon container, je dois taper la commande suivante&nbsp;:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stop charming_pare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Quand on tape des lignes de commande en bash, utilisez la touche <code>tab</code> pour auto-compléter la commande. Par exemple, ici, j’ai seulement tapé <code>docker stop ch</code> puis appuyé sur tab qui a complété le nom de mon container. Pratique, non&nbsp;? N’hésitez pas à en abuser. Si l’auto-complete ne fonctionne pas, c’est qu’il ne trouve rien OU plusieurs résultats. Dans ce cas, continuez à écrire la commande à la main et réessayez.</p>
</div>
</div>
<p>Utilisez à nouveau la commande <code>docker ps</code> pour vérifier que ce container n’apparaît plus dans la liste. Normalement, si vous actualisez la page GeoServer, vous devriez avoir une erreur du type “localhost refused to connect”.</p>
<p><strong>Alors, c’est bien sympa tout ça, mais en l’état, on ne va pas pouvoir ajouter de données dans notre container.</strong> Il faudrait pouvoir accéder au dossier <code>/data</code> de GeoServer. Heureusement, pour nous simplifier la vie, on peut utiliser Docker pour “connecter” deux dossiers en eux (monter, <em>mount</em> en anglais). Pour ça, il faut créer sur notre ordinateur un nouveau dossier dans lequel on mettra tout ce qu’on veut retrouver dans le <code>/data</code> de notre GeoServer. Promis, c’est la dernière étape aussi technique, ensuite je me détends et j’arrête de vous faire taper autant de lignes de commande.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExYmtrc2k0ZGljMG0yZm41M3Nhd2Zlb2FidndvcWVtbDRhOTUwZ3cxdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/7hJZcKzjIufeOmqKSj/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Code code code"></p>
</figure>
</div>
<p>D’abord, on supprime notre container. On va en créer un nouveau dans les étapes suivantes.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> rm <span class="op">&lt;</span>nom_du_container<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ensuite, on va créer un dossier à monter sur le <code>/data</code> de notre container.</p>
<ul>
<li><p>Allez dans Documents et créer un nouveau dossier “GeoServer”.</p></li>
<li><p>Copiez le chemin ABSOLU vers ce dossier. Par exemple, chez moi (Ubuntu), ça donne ça&nbsp;: <code>/home/marie/Documents/GeoServer</code></p></li>
<li><p>Remplacez <code>"/absolute/path/on/host"</code> dans la commande suivante et copiez-collez la quelque part, on ne sait jamais.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-it</span> <span class="at">-p</span> 80:8080 <span class="at">--mount</span> src=<span class="st">"/absolute/path/on/host"</span>,target=/opt/geoserver_data/,type=bind docker.osgeo.org/geoserver:2.26.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Exécutez la ligne de commande.</li>
</ul>
<p>Maintenant, on va ajouter notre jeu de données <code>land_matrix_mines</code> à notre dossier <code>/data</code>.</p>
<ul>
<li><p>Téléchargez le jeu de données <a href="../../data/land_matrix/land_matrix_mines.gpkg">land_matrix_mines</a>.</p></li>
<li><p>Dans l’explorateur de fichiers de votre ordinateur, ouvrez votre dossier GeoServer. Normalement, vous auriez du voir apparaître plusieurs nouveaux dossiers. Allez dans <code>/data</code> et créez un nouveau dossier <code>geopackage</code>.</p></li>
<li><p>Glissez le fichier <code>land_matrix_mines.gpkg</code> dans le dossier <code>geopackage</code>.</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Je ne peux pas créer de nouveau dossier / déplacer mon fichier !
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Si vous ne pouvez pas créer de nouveau dossier, c’est que vous ne disposez pas des permissions suffisantes. Dans mon cas (sur Ubuntu), tous les dossiers appartenaient à l’utilisateur et au groupe <code>root</code>. Il faut utiliser la commande <code>chown</code>&nbsp;:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> <span class="op">&lt;</span>user<span class="op">&gt;</span>:<span class="op">&lt;</span>group<span class="op">&gt;</span> /chemin/vers/mon/dossier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour changer les droits de mon dossier `/home/marie/Documents/GeoServer` j’ai donc tapé&nbsp;:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> marie:marie /home/marie/Documents/GeoServer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Si ça ne fonctionne pas, ne restez pas bloqués et appelez-moi, on règle ça ensemble.</p>
</div>
</div>
</div>
<p>C’est bon, ça fonctionne&nbsp;? Parfait&nbsp;! Les règles pour arrêter et démarrer son container restent les mêmes. Tout ce qu’il faut retenir, c’est qu’il ne faut pas supprimer ou déplacer votre dossier GeoServer sous peine de tout casser. Pour le reste, tout devrait fonctionner tranquillement.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rappel des commandes principales
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lister les containers actifs</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lister tous les containers, même arrêtés</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps <span class="at">-a</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Démarrer mon container</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> start <span class="op">&lt;</span>nom_du_container<span class="op">&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrêter mon container</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stop <span class="op">&lt;</span>nom_du_container<span class="op">&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># /!\ Supprimer mon container</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> rm <span class="op">&lt;</span>nom_du_container<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Vous avez survécu au déploiement du GeoServer, bien joué&nbsp;! Prenez un moment pour souffler, allez vous chercher un café. La suite sera beaucoup moins prise de tête, c’est promis&nbsp;!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExdmJ0amd0cmRoY2dyZXZmYndiNzd3MWM5amEybTY0bW92ZXkxaXo3ayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ceeFbVxiZzMBi/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Pause café"></p>
</figure>
</div>
</section>
<section id="espaces-de-travail-entrepôts-et-couches" class="level3">
<h3 class="anchored" data-anchor-id="espaces-de-travail-entrepôts-et-couches">Espaces de travail, Entrepôts et Couches</h3>
<p>Créer un <strong>espace de travail</strong>, c’est facile, on vient de le faire. Maintenant, on va créer un nouveau dépôt par défaut qu’on appellera <code>land_matrix</code> et dans lequel on ajoutera notre geopackage.</p>
<ul>
<li><p>Allez dans “Espaces de travail” et cliquez sur “Ajouter un nouvel espace de travail”.</p></li>
<li><p>Nommez l’espace de travail “land_matrix” et donnez lui l’URI “land_matrix”.</p></li>
<li><p>Cochez “Espace de travail par défaut”.</p></li>
<li><p>Ciquez sur “Sauvegarder”.</p></li>
</ul>
<p>Si tout va bien, on voit maintenant notre espace “land_matrix” dans la liste. On va pouvoir ajouter un <strong>entrepôt</strong> de données dans notre espace.</p>
<ul>
<li><p>Allez dans “Entrepôts” et cliquez sur “Ajouter un nouvel entrepôt”. Vous allez voir une liste de tous les types d’entrepôts de données qui peuvent être ajoutés à votre espace de travail, par exempe du GeoPackage, une base PostGIS, un Shapefile ou encore un flux WMS distant.</p></li>
<li><p>Sélectionnez “GeoPackage”.</p></li>
<li><p>Nommez la source de données “land_matrix_mines” et ajoutez une petite description, par exemple “Transactions minières de la Land Matrix, 2024”.</p></li>
<li><p>Dans “<strong>Paramètres de connexion</strong>” cliquez sur “Parcourir…” à droite de “database *”.</p></li>
<li><p>Allez dans <code>data/geopackage/</code> et cliquez sur le jeu de données <code>land_matrix_mines.gpkg</code>.</p></li>
<li><p>Videz le champ “passwd”.</p></li>
<li><p>Cliquez sur “Sauvegarder”.</p></li>
</ul>
<p>Une fois de retour sur la page “Entrepôts”, vous devriez voir votre entrepôt “land_matrix_mines” associé à l’espace de travail “land_matrix”. On avance&nbsp;! Maintenant, on veut publier et lire des <strong>couches</strong>.</p>
<ul>
<li><p>Allez dans “Couches” et cliquez sur “Ajouter une nouvelle couche”.</p></li>
<li><p>Sélectionnez “land_matrix:land_matrix_mines”. Vous devriez voir apparaître une liste de couches.</p></li>
<li><p>Cliquez sur “Publier” à droite de la couche “deals”.</p></li>
</ul>
<p>L’onglet de publication de couche permet de configurer la couche et d’y ajouter de la métadonnée. Dans ce TP, on se concentrera sur les informations “cruciales” pour définir une couche, mais vous pourrez toujours allez plus loin en utilisant la <a href="https://docs.geoserver.org/latest/en/user/data/webadmin/layers.html">documentation GeoServer sur les couches</a>.</p>
<p>Les trois choses à faire absolument à chaque fois dans l’onglet données sont&nbsp;:</p>
<ul>
<li><p>Renseigner les informations dans “<strong>Informations de base sur les donneés</strong>” comme le nom de la couche et un résumé. N’oubliez pas de laisser “Activé” et “Publié” cochés pour rendre la couche accessible depuis l’extérieur.</p></li>
<li><p>Vérifier le “<strong>Système de Référence de Coordonnées (SRC)</strong>” qui doit être pré-rempli en EPSG:4326 dans notre cas. Il correspond à la projection WGS84 utilisée dans la grande majorité des cas en cartographie web.</p></li>
<li><p>Définir les “<strong>Emprises</strong>” qui se calculent automatiquement sur GeoServer en cliquant sur “Calculer depuis les limites du SRS” et “Calculées sur les emprises natives”.</p></li>
</ul>
<p>Cliquez ensuite sur “Appliquer” pour sauvegarder vos changements et scrollez en haut de la page pour accéder à l’onglet “Publication”.</p>
<ul>
<li>Dans “<strong>Paramètres de couche</strong>”, cochez Interrogeable et vérifiez que le style par défaut est bien “point”.</li>
</ul>
<p>Cliquez sur “Sauvegarder”. La couche devrait maintenant apparaître au sommet du tableau. Cliquez simplement sur le nom de la couche (ici “deals”) pour la paramétrer à nouveau si besoin. Pour vérifier que tout a fonctionné, on peut prévisualiser la couche directement depuis GeoServer.</p>
<ul>
<li><p>Allez dans “Prévisualisation de la Couche” (menu à gauche de l’écran).</p></li>
<li><p>Sur la ligne de la couche “deals”, sélectionnez “OpenLayers”.</p></li>
</ul>
<p>Vous devriez voir apparaître quelque chose comme ça, avec des informations supplémentaires si vous cliquez sur des points (possible car notre couche est interrogeable)&nbsp;:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../static/captures/geonum_geoserver_layer_preview.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Prévisualisation de la couche deals dans GeoServer"></p>
</figure>
</div>
<p>Si c’est bon, bravo, ça a fonctionné ! Si vous voyez des artefacts autour des points, c’est normal. Ce que vous regardez, ce ne sont pas des polygones mais une image produite à partir de notre couche et transmise comme un flux WMS par notre serveur. L’intérêt, c’est qu’on peut afficher rapidement des couches très lourdes de cette manière, là où un GeoJSON commencerait à ramer. Et on peut toujours zoomer et cliquer sur un point pour l’interroger. C’est super pratique&nbsp;! Ce flux WMS est récupéré et lu par une petite appli OpenLayers, c’est comme ça que vous êtes capable de voir la couche sur votre page web (vous sentez venir la transition vers les prochains cours, là&nbsp;?).</p>
<p>Bon, super, on a notre couche moche. Maintenant, on en fait quoi de tous ces points rouges&nbsp;?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExd3BzbHR2azJzMTA0cWlzNG04ZDZsY2t4OW45dHRwNnEyNDFsOXNuOCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/U4Jrf8bUUdDLG/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Poisson et pointer laser"></p>
</figure>
</div>
<p>Facile. On va d’abord la rendre un peu plus belle, puis on va la lire dans notre propre application OpenLayers et commencer à faire des trucs cools avec. <strong>Mais avant</strong>, comme vous avez tout compris à ce qu’on vient de faire, ajoutez toutes les autres couches du geopackage à votre espace de travail. Quand vous avez réussi à toutes les prévisualiser (et pleuré devant leur style austère), créez un nouveau projet QGIS et importez aussi ces couches.</p>
</section>
<section id="styliser-mes-couches" class="level3">
<h3 class="anchored" data-anchor-id="styliser-mes-couches">Styliser mes couches</h3>
<p><a href="https://docs.geoserver.org/main/en/user/styling/index.html#styling">Documentation GeoServer “Styling”</a></p>
<p>Pour le moment, afficher notre couche “deals” va juste donner l’impression que notre carte a attrappé la varicelle. On va commencer par changer son apparence en faisant des points bien ronds et d’une couleur qui crie moins “DANGER&nbsp;!!!”. Pour ça, on va devoir <strong>créer un nouveau style</strong>.</p>
<ul>
<li><p>Allez dans “Styles” et cliquer sur “Ajouter un nouveau style”.</p></li>
<li><p>Nommez le style “deals” et choisissez l’espace de travail “land_matrix”. Conservez le format SLD, c’est le seul disponible sans ajouter d’extensions.</p></li>
<li><p>Pour nous aider, GeoServer propose de générer un SLD par défaut. Sélectionnez “Point” et cliquez sur “Générer…”. Vous devriez vous retrouver avec un fichier .xml décrivant la couche.</p></li>
</ul>
<p>On pourrait aller lire en détail le <a href="https://docs.geoserver.org/main/en/user/styling/sld/cookbook/index.html">SLD Cookbook</a> de GeoServer pour écrire notre fichier manuellement, mais on est plus malins que ça. On a un super outil à disposition qui s’appelle QGIS.</p>
<ul>
<li><strong>Si vous ne l’avez pas déjà fait, créez un projet QGIS et ajoutez les couches Land Matrix.</strong></li>
<li>Donnez un style sympa aux points de la couche deals. J’ai changé la couleur pour les rendre orange.</li>
<li>Allez dans les propriétés de votre couche et dans “Symbologie”. Tout en bas, choisissez “Style” et “Enregistrer le style…”.</li>
<li>Choisissez l’option “En tant que fichier SLD” et choisissez le chemin et le nom de votre fichier en cliquant sur “…” après “Fichier”. J’ai appelé le mien “deals.sld”</li>
<li>Allez chercher votre fichier et ouvrez-le avec un éditeur de texte (Notepad, VSCode, peu importe).</li>
<li>Copiez le contenu.</li>
<li>Retournez sur votre page GeoServer, supprimez tout le contenu de la zone de texte et collez à la place le contenu de <code>deals.sld</code>. Voilà ce que ça donne pour moi&nbsp;:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">"1.0"</span><span class="ot"> encoding=</span><span class="st">"UTF-8"</span><span class="fu">?&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">StyledLayerDescriptor</span><span class="ot"> xmlns=</span><span class="st">"http://www.opengis.net/sld"</span><span class="ot"> xmlns:se=</span><span class="st">"http://www.opengis.net/se"</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span><span class="ot"> xsi:schemaLocation=</span><span class="st">"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.1.0/StyledLayerDescriptor.xsd"</span><span class="ot"> xmlns:xsi=</span><span class="st">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="ot"> xmlns:xlink=</span><span class="st">"http://www.w3.org/1999/xlink"</span><span class="ot"> version=</span><span class="st">"1.1.0"</span>&gt;</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">UserStyle</span>&gt;</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;Deal&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#ffd157&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;7&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>      &lt;/<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">UserStyle</span>&gt;</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">StyledLayerDescriptor</span>&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Vous pouvez prévisualiser la légende en cliquant sur “Aperçu de la légende”. Le bouton “Ajouter une légende” permet quand à lui d’ajouter une image customisée plutôt qu’une génération automatique. C’est pratique quand on a des légendes complexes, mais pas pour le moment. Ensuite, sauvegardez la légende quand elle vous convient.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Une autre méthode pour charger le contenu d’un fichier de style .sld est de cliquer sur “Browse” en dessous de “Fichier de style”. Allez chercher votre fichier .sld et cliquez sur “Charger…” pour vous économiser quelques copier-coller par la suite&nbsp;!</p>
</div>
</div>
<p>Maintenant, il faut dire à GeoServer qu’on veut utiliser ce style avec notre couche “deals”.</p>
<ul>
<li>Allez dans “Couches”.</li>
<li>Sélectionnez la couche “deals et allez dans l’onglet”Publication”.</li>
<li>Dans “Style par défaut”, sélectionnez “land_matrix:deals” et Sauvegardez.</li>
</ul>
<p>Maintenant, vous pouvez de nouveau prévisualiser la couche “deals” et voilà&nbsp;! Nos points sont ronds et jaunes. Vous savez maintenant créer un nouveau style SLD depuis QGIS et l’ajouter à une couche dans GeoServer&nbsp;!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNzVzNTF4cGtqaW9lZmR5MHRtdG93c3dvcHE0Zjk3dWJsYWJzejdwcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/rkq5mivgZVh8yN8zfy/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Cristina Cordula"></p>
</figure>
</div>
<p>Normalement, vous commencez à bien comprendre le fonctionnement de GeoServer et la publication des couches. Créez un style de couleur unique pour “deals_by_country” qu’on utilisera comme pseudo fond de carte. Ensuite, créez un style en cercles proportionnels pour “deals_by_country_centroid” en vous basant sur l’attribut “surface_ha”.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention à la sémiologie
</div>
</div>
<div class="callout-body-container callout-body">
<p>Je ne veux pas voir de polygones “deals_by_country” de différentes couleurs. <strong>On n’utilise pas de carte choroplèthe pour représenter une valeur absolue, elles servent pour les valeurs relatives ou les catégories.</strong></p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExN2FzZWozcWc0bnIyMmVscjZ5a2N4d29yZjVic2oyNmZ3NDNzdHhqZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3eRtlBVLi5tLPhmn11/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: I'm watching you"></p>
</figure>
</div>
<p>Une fois que vous avez au moins ajouté votre style à “deals_by_country” dans GeoServer, vous pouvez passer à la suite. Si vous avez un train de retard, cliquez sur les boutons ci-dessous pour dérouler mes styles et les copier-coller dans votre GeoServer.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SLD pour “deals_by_country”
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">"1.0"</span><span class="ot"> encoding=</span><span class="st">"UTF-8"</span><span class="fu">?&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">StyledLayerDescriptor</span><span class="ot"> xmlns=</span><span class="st">"http://www.opengis.net/sld"</span><span class="ot"> xmlns:se=</span><span class="st">"http://www.opengis.net/se"</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span><span class="ot"> xsi:schemaLocation=</span><span class="st">"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.1.0/StyledLayerDescriptor.xsd"</span><span class="ot"> xmlns:xsi=</span><span class="st">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="ot"> xmlns:xlink=</span><span class="st">"http://www.w3.org/1999/xlink"</span><span class="ot"> version=</span><span class="st">"1.1.0"</span>&gt;</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals_by_country&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">UserStyle</span>&gt;</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals_by_country&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;Single symbol&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PolygonSymbolizer</span>&gt;</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#fdbf6f&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill-opacity"</span>&gt;0.35&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;1&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-linejoin"</span>&gt;bevel&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PolygonSymbolizer</span>&gt;</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      &lt;/<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">UserStyle</span>&gt;</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">StyledLayerDescriptor</span>&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SLD pour “deals_by_country_centroid”
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb13"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">"1.0"</span><span class="ot"> encoding=</span><span class="st">"UTF-8"</span><span class="fu">?&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">StyledLayerDescriptor</span><span class="ot"> xmlns=</span><span class="st">"http://www.opengis.net/sld"</span><span class="ot"> xmlns:se=</span><span class="st">"http://www.opengis.net/se"</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span><span class="ot"> xsi:schemaLocation=</span><span class="st">"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.1.0/StyledLayerDescriptor.xsd"</span><span class="ot"> xmlns:xsi=</span><span class="st">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="ot"> xmlns:xlink=</span><span class="st">"http://www.w3.org/1999/xlink"</span><span class="ot"> version=</span><span class="st">"1.1.0"</span>&gt;</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals_by_country_centroid&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">UserStyle</span>&gt;</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:Name</span>&gt;gpkg_land_matrix — deals_by_country_centroid&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;201 - 5466&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Title</span>&gt;201 - 5466&lt;/<span class="kw">se:Title</span>&gt;</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">ogc:Filter</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span>&gt;</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsGreaterThanOrEqualTo</span>&gt;</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;200.81000000000000227&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsGreaterThanOrEqualTo</span>&gt;</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;5466.3999999999996362&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">ogc:Filter</span>&gt;</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#e5b636&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;4&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;5466 - 20413&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Title</span>&gt;5466 - 20413&lt;/<span class="kw">se:Title</span>&gt;</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">ogc:Filter</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span>&gt;</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;5466.3999999999996362&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;20412.80000000001018634&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">ogc:Filter</span>&gt;</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#e5b636&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;10&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;20413 - 61376&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Title</span>&gt;20413 - 61376&lt;/<span class="kw">se:Title</span>&gt;</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">ogc:Filter</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span>&gt;</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;20412.80000000001018634&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;61375.88199999996868428&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">ogc:Filter</span>&gt;</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#e5b636&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;16&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;61376 - 160220&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Title</span>&gt;61376 - 160220&lt;/<span class="kw">se:Title</span>&gt;</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">ogc:Filter</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span>&gt;</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;61375.88199999996868428&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;160220.00000000005820766&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">ogc:Filter</span>&gt;</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#e5b636&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;22&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Name</span>&gt;160220 - 1509612&lt;/<span class="kw">se:Name</span>&gt;</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Title</span>&gt;160220 - 1509612&lt;/<span class="kw">se:Title</span>&gt;</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:Description</span>&gt;</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">ogc:Filter</span><span class="ot"> xmlns:ogc=</span><span class="st">"http://www.opengis.net/ogc"</span>&gt;</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;160220.00000000005820766&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsGreaterThan</span>&gt;</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:PropertyName</span>&gt;suface_ha&lt;/<span class="kw">ogc:PropertyName</span>&gt;</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">ogc:Literal</span>&gt;1509612&lt;/<span class="kw">ogc:Literal</span>&gt;</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">ogc:PropertyIsLessThanOrEqualTo</span>&gt;</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">ogc:And</span>&gt;</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">ogc:Filter</span>&gt;</span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>          &lt;<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:WellKnownName</span>&gt;circle&lt;/<span class="kw">se:WellKnownName</span>&gt;</span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"fill"</span>&gt;#e5b636&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Fill</span>&gt;</span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke"</span>&gt;#232323&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>                  &lt;<span class="kw">se:SvgParameter</span><span class="ot"> name=</span><span class="st">"stroke-width"</span>&gt;0.5&lt;/<span class="kw">se:SvgParameter</span>&gt;</span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">se:Stroke</span>&gt;</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>              &lt;/<span class="kw">se:Mark</span>&gt;</span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>              &lt;<span class="kw">se:Size</span>&gt;29&lt;/<span class="kw">se:Size</span>&gt;</span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">se:Graphic</span>&gt;</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>          &lt;/<span class="kw">se:PointSymbolizer</span>&gt;</span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">se:Rule</span>&gt;</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a>      &lt;/<span class="kw">se:FeatureTypeStyle</span>&gt;</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">UserStyle</span>&gt;</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">NamedLayer</span>&gt;</span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">StyledLayerDescriptor</span>&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="lire-mes-flux-dans-une-autre-application" class="level3">
<h3 class="anchored" data-anchor-id="lire-mes-flux-dans-une-autre-application">Lire mes flux dans une autre application</h3>
<p>Courage, on touche au but. Vous aurez bientôt fait le tour du fonctionnement basique de GeoServer. Maintenant qu’on a nos couches, on veut pouvoir les lire.</p>
<p>Pour commencer, on va rapidement vérifier qu’on communique bien avec notre GeoServer en utilisant QGIS et la requête <code>GetCapabilities</code> du serveur. Cette requête, lorsqu’elle réussit, nous répond avec un fichier .xml qui explique à QGIS tout ce que le serveur est capable de faire, et notamment quelles couches peuvent être affichées.</p>
<ul>
<li><p>Dans QGIS, cliquez sur “Ajouter une couche” et sélectionnez “WMS”.</p></li>
<li><p>Dans l’onglet “Couches”, cliquez sur “Nouveau”.</p></li>
<li><p>Appelez la connexion “mon_geoserver” et collez l’url <code>GetCapabilities</code> dans “URL”. Elle devrait être identique à celle-ci&nbsp;:</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>http://localhost/geoserver/land_matrix/wms?service=WMS<span class="er">&amp;</span>version=1.1.0<span class="er">&amp;</span>request=GetCapabilities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ça ne fonctionne pas&nbsp;!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Pour vérifier que votre requête est bonne, allez dans GeoServer, affichez n’importe quelle couche en prévisualisation et copiez l’adresse.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>http://localhost/geoserver/land_matrix/wms?service=WMS<span class="er">&amp;</span>version=1.1.0<span class="er">&amp;</span>request=GetMap<span class="er">&amp;</span>layers=land_matrix%3Adeals<span class="er">&amp;</span>bbox=-180.0%2C-90.0%2C180.0%2C90.0<span class="er">&amp;</span>width=768<span class="er">&amp;</span>height=384<span class="er">&amp;</span>srs=EPSG%3A4326<span class="er">&amp;</span>styles=<span class="er">&amp;</span>format=application/openlayers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Supprimez tout ce qui se trouve après “request=” et ajoutez “GetCapabilities”.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>http://localhost/geoserver/land_matrix/wms?service=WMS<span class="er">&amp;</span>version=1.1.0<span class="er">&amp;</span>request=GetCapabilities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Cliquez ensuite sur “Connexion” et vérifiez qu’une liste de couche apparaît et qu’elle contient bien vos couches “deals”, etc.</li>
</ul>
<p>Vous pouvez afficher la couche dans QGIS avec “Add” si vous le souhaitez. L’essentiel, c’est qu’on a vérifier que notre serveur émet bien des flux WMS pour nos couches et qu’on peut bien les lire. On va maintenant faire la même chose dans une application OpenLayers. Comme on n’a pas encore commencé les cours, je vous donne le code. Vous verrez, ça ressemble beaucoup à Leaflet. Dans le dossier de votre choix, créez un document <code>index.html</code> et collez le contenu suivant&nbsp;:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">"en"</span><span class="dt">&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>GeoServer + OpenLayers<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">"UTF-8"</span><span class="dt">&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> name</span><span class="op">=</span><span class="st">"viewport"</span><span class="ot"> content</span><span class="op">=</span><span class="st">"width=device-width"</span><span class="dt">&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- CSS --&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">link</span><span class="ot"> rel</span><span class="op">=</span><span class="st">"stylesheet"</span><span class="ot"> href</span><span class="op">=</span><span class="st">"https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.1.0/ol/ol.css"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#map</span> {</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">height</span><span class="ch">:</span> <span class="dv">500</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">width</span><span class="ch">:</span> <span class="dv">800</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>GeoServer + OpenLayers<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">"map"</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- OpenLayers JS--&gt;</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.1.0/ol/dist/ol.js"</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- App code --&gt;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="co">// OSM layer and source</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> source_osm <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="fu">OSM</span>()</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> layer_osm <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="fu">Tile</span>({ <span class="dt">source</span><span class="op">:</span> source_osm })</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>            <span class="co">// GeoServer layer and source</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Map</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> map <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">Map</span>({</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                <span class="dt">target</span><span class="op">:</span> <span class="st">'map'</span><span class="op">,</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                <span class="dt">layers</span><span class="op">:</span> [ layer_osm ]<span class="op">,</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                <span class="dt">view</span><span class="op">:</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">View</span>({</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>                <span class="dt">center</span><span class="op">:</span> ol<span class="op">.</span><span class="at">proj</span><span class="op">.</span><span class="fu">fromLonLat</span>([<span class="fl">2.1833</span><span class="op">,</span> <span class="fl">41.3833</span>])<span class="op">,</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>                <span class="dt">zoom</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Double-cliquez sur <code>index.html</code> pour l’ouvrir dans le navigateur. Vous devriez voir apparaître une carte avec un fond OSM. On va ajouter nos couches GeoServer à cette carte.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="../../static/captures/geonum_geoserver_openlayers_1.png" class="img-fluid quarto-figure quarto-figure-left figure-img" alt="Aperçu de la page web avec une carte OpenLayers"></p>
</figure>
</div>
<p>Sous la section commentée “GeoServer Layer and source”, ajoutez les lignes suivantes :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> url_geoserver <span class="op">=</span> <span class="st">'http://localhost/geoserver/land_matrix/wms'</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> source_geoserver <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="fu">ImageWMS</span>({</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">url</span><span class="op">:</span> url_geoserver<span class="op">,</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">params</span><span class="op">:</span> {<span class="st">'LAYERS'</span><span class="op">:</span> <span class="st">'land_matrix:deals'</span>}<span class="op">,</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">serverType</span><span class="op">:</span> <span class="st">'geoserver'</span><span class="op">,</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> layer_geoserver <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="fu">Image</span>({ <span class="dt">source</span><span class="op">:</span> source_geoserver })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Et ajoutez <code>layer_geoserver</code> à la liste de couches de <code>map</code>&nbsp;:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Map</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> map <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">Map</span>({</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">target</span><span class="op">:</span> <span class="st">'map'</span><span class="op">,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layers</span><span class="op">:</span> [ layer_osm<span class="op">,</span> layer_geoserver ]<span class="op">,</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">view</span><span class="op">:</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">View</span>({</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">center</span><span class="op">:</span> ol<span class="op">.</span><span class="at">proj</span><span class="op">.</span><span class="fu">fromLonLat</span>([<span class="fl">2.1833</span><span class="op">,</span> <span class="fl">41.3833</span>])<span class="op">,</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zoom</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Actualisez la carte. Vous devriez maintenant voir apparaître la couche “deals” de l’entrepôt “land_matrix”&nbsp;! Décortiquons rapidement ces lignes de code.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> url_geoserver <span class="op">=</span> <span class="st">'http://localhost/geoserver/land_matrix/wms'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On récupère l’url de notre serveur. Si vous ne la trouvez pas, allez dans votre GeoServer et prévisualisez n’importe quelle couche. Récupérez l’url et coupez tout après “wms”. <code>land_matrix</code> est l’URI que nous avons donné à notre espace de travail (voir la section Espaces de travail du TP).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> source_geoserver <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="fu">ImageWMS</span>({</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">url</span><span class="op">:</span> url_geoserver<span class="op">,</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">params</span><span class="op">:</span> {<span class="st">'LAYERS'</span><span class="op">:</span> <span class="st">'land_matrix:deals'</span>}<span class="op">,</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">serverType</span><span class="op">:</span> <span class="st">'geoserver'</span><span class="op">,</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On crée ensuite une nouvelle source de données de type <code>ImageWMS</code>. On indique l’url de la source, à savoir l’url de notre espace de données GeoServer stocké dans la variable <code>url_geoserver</code>. L’image prend aussi un ou plusieurs paramètres. On indique dans ‘LAYERS’ la couche qu’on souhaite afficher. Celle ligne s’écrit toujours sous la forme&nbsp;:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="st">'LAYERS'</span> <span class="op">:</span> <span class="st">'&lt;entrepôt&gt;:&lt;couche&gt;'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Si vous avez un doute, allez dans “Prévisualisation de la couche” et regardez le contenu de la colonne “Nom”. C’est la valeur à donner à ‘LAYERS’.</p>
<p>Enfin, on renseigne le type du serveur, ici ‘geoserver’. Ce paramètre permet à OpenLayers de communiquer plus facilement avec GeoServer lorsque vous utiliserez des fonctionnalités plus avancées. De manière générale, cela vous permet aussi de vous souvenir du type de serveur avec lequel vous communiquez.</p>
<p>Chouette, après tout ça on a enfin réussi à créer, lire et afficher un flux WMS&nbsp;! Sauf que, il manque encore quelque chose… la légende&nbsp;! Et là vous me dites “pitié, j’en peux plus, j’ai la tête qui va exploser”. Allez, encore un petit effort. On a vu que GeoServer est capable de générer tout seul une légende, il nous suffit donc de la récupérer. Pour ça, rien de plus facile&nbsp;! Le serveur distribue les images comme il distribue les couches de données. Il nous suffit de récupérer l’image en question et l’afficher dans une nouvelle <code>&lt;div&gt;</code> sur notre carte.</p>
<p>On reviendra en détail sur le fonctionnement des légendes dans le TP sur OpenLayers. Commencez par créer une <code>&lt;div&gt;</code> pour la légende sous <code>&lt;div id="map"&gt;&lt;/div&gt;</code> :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">"map"</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> id</span><span class="op">=</span><span class="st">"legend"</span><span class="ot"> </span><span class="dt">/&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notre script permettra de modifier la source de l’image <code>legend</code> en interrogeant GeoServer à chaque fois qu’on fera changer la résolution de la carte. Dans le tag <code>&lt;script&gt;</code>, en dessous du code de la carte “Map”, ajoutez les lignes suivantes :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- App code --&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">//…</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Function to update the legend    </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">updateLegend</span>(resolution) {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> graphicUrl <span class="op">=</span> source_geoserver<span class="op">.</span><span class="fu">getLegendUrl</span>(resolution<span class="op">,</span> { <span class="st">'LEGEND_OPTIONS'</span> <span class="op">:</span> <span class="st">'forceLabels:on'</span> })<span class="op">;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> img <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'legend'</span>)<span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        img<span class="op">.</span><span class="at">src</span> <span class="op">=</span> graphicUrl<span class="op">;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initial legend</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> resolution <span class="op">=</span> map<span class="op">.</span><span class="fu">getView</span>()<span class="op">.</span><span class="fu">getResolution</span>()<span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateLegend</span>(resolution)<span class="op">;</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Update legend when resolution changes</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">getView</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">'change:resolution'</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> resolution <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">getResolution</span>()<span class="op">;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">updateLegend</span>(resolution)<span class="op">;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>En résumé&nbsp;:</p>
<ul>
<li><p>La fonction <code>updateLegend()</code> permet de récupérer l’url de la légende depuis notre source GeoServer <code>source_geoserver</code> en utilisant la méthode <code>getLegendUrl()</code>. On modifie ensuite la source de notre image <code>&lt;img id="legend" /&gt;</code> sur l’url de la légende.</p></li>
<li><p>La fonction <code>getLegendUrl()</code> a besoin de connaître la résolution de la carte pour fonctionner.</p></li>
<li><p>Lorsque la carte est créée pour la première fois, on stocke sa résolution dans la variable <code>resolution</code>. La méthode <code>getView()</code> de l’objet <code>map</code> permet de récupérer la valeur de cette résolution. Ensuite, on exécute notre fonction <code>updateLegend()</code> pour récupérer la légende une première fois.</p></li>
<li><p>Pour mettre à jour la légende lorsque la résolution change, on écoute les évènements <code>change:resolution</code> de la map. À chaque fois que la résolution change, on va récupérer à nouveau cette résolution et exécuter la fonction <code>updateLegend()</code>.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code complet de l’application
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb25"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">"en"</span><span class="dt">&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>GeoServer + OpenLayers<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">"UTF-8"</span><span class="dt">&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> name</span><span class="op">=</span><span class="st">"viewport"</span><span class="ot"> content</span><span class="op">=</span><span class="st">"width=device-width"</span><span class="dt">&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- CSS --&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">link</span><span class="ot"> rel</span><span class="op">=</span><span class="st">"stylesheet"</span><span class="ot"> href</span><span class="op">=</span><span class="st">"https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.1.0/ol/ol.css"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#map</span> {</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">height</span><span class="ch">:</span> <span class="dv">500</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">width</span><span class="ch">:</span> <span class="dv">800</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>GeoServer + OpenLayers<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">"map"</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> id</span><span class="op">=</span><span class="st">"legend"</span><span class="ot"> </span><span class="dt">/&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- OpenLayers JS--&gt;</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.1.0/ol/dist/ol.js"</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&lt;!-- App code --&gt;</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            <span class="co">// OSM layer and source</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> source_osm <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="fu">OSM</span>()</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> layer_osm <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="fu">Tile</span>({ <span class="dt">source</span><span class="op">:</span> source_osm })</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            <span class="co">// GeoServer layer and source</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> url_geoserver <span class="op">=</span> <span class="st">'http://localhost/geoserver/land_matrix/wms'</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> source_geoserver <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="fu">ImageWMS</span>({</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>                <span class="dt">url</span><span class="op">:</span> url_geoserver<span class="op">,</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>                <span class="dt">params</span><span class="op">:</span> {<span class="st">'LAYERS'</span><span class="op">:</span> <span class="st">'land_matrix:deals'</span>}<span class="op">,</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>                <span class="dt">serverType</span><span class="op">:</span> <span class="st">'geoserver'</span><span class="op">,</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> layer_geoserver <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="fu">Image</span>({ <span class="dt">source</span><span class="op">:</span> source_geoserver })</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Map</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> map <span class="op">=</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">Map</span>({</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                <span class="dt">target</span><span class="op">:</span> <span class="st">'map'</span><span class="op">,</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                <span class="dt">layers</span><span class="op">:</span> [ layer_osm<span class="op">,</span> layer_geoserver ]<span class="op">,</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                <span class="dt">view</span><span class="op">:</span> <span class="kw">new</span> ol<span class="op">.</span><span class="fu">View</span>({</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>                <span class="dt">center</span><span class="op">:</span> ol<span class="op">.</span><span class="at">proj</span><span class="op">.</span><span class="fu">fromLonLat</span>([<span class="fl">2.1833</span><span class="op">,</span> <span class="fl">41.3833</span>])<span class="op">,</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>                <span class="dt">zoom</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Function to update the legend    </span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>            <span class="kw">function</span> <span class="fu">updateLegend</span>(resolution) {</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> graphicUrl <span class="op">=</span> source_geoserver<span class="op">.</span><span class="fu">getLegendUrl</span>(resolution<span class="op">,</span> { <span class="st">'LEGEND_OPTIONS'</span> <span class="op">:</span> <span class="st">'forceLabels:on'</span> })<span class="op">;</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> img <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'legend'</span>)<span class="op">;</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                img<span class="op">.</span><span class="at">src</span> <span class="op">=</span> graphicUrl<span class="op">;</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>            }<span class="op">;</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Initial legend</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> resolution <span class="op">=</span> map<span class="op">.</span><span class="fu">getView</span>()<span class="op">.</span><span class="fu">getResolution</span>()<span class="op">;</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">updateLegend</span>(resolution)<span class="op">;</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Update legend when resolution changes</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>            map<span class="op">.</span><span class="fu">getView</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">'change:resolution'</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> resolution <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">getResolution</span>()<span class="op">;</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>                <span class="fu">updateLegend</span>(resolution)<span class="op">;</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Ouf&nbsp;!</strong> On a enfin une légende. Pour ceux qui ont encore le temps et l’énergie, je vous propose d’<strong>afficher les autres couches et leur légende sur la carte</strong>, au moins “deals_by_country_centroids” pour avoir nos cercles proportionnels. C’est parti&nbsp;!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExOWFxaHJ2azNsbno2NzRwaDc2c29rdjJwbnltYmJqdjVzM3B3aHV4biZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/d31vTpVi1LAcDvdm/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Bob Ross"></p>
</figure>
</div>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusion(s)</h2>
<ul>
<li><p>C’est quoi l’intérêt du serveur carto, déjà&nbsp;?</p>
<ul>
<li><p>Centralisation de la donnée et mise à jour</p></li>
<li><p>Distribution de la donnée</p></li>
<li><p>Gestion des droits</p></li>
<li><p>Bien quand on a une organisation et bcp de données, s’intègre très bien dans une IDG</p></li>
<li><p>Bien pour les couches Raster et les couches Vecteur lourdes qui peuvent être servies en tant qu’images (WMS)</p></li>
<li><p>Connexion directe à une base de données PostgreSQL</p></li>
<li><p>Possibilité d’écrire des requêtes SQL pour former les couches</p></li>
<li><p>Possibilité de créer des styles complexes “à la QGIS”.</p></li>
</ul></li>
<li><p>Est-ce que j’en ai besoin pour mon projet GeoNum&nbsp;?</p>
<ul>
<li>Ça dépend des données que vous utilisez et ce que vous en faites. Le mieux c’est d’en discuter avec les profs&nbsp;!</li>
</ul></li>
<li><p>Je n’utilise pas de connexion à une base de données, je préfère juste afficher des couches avec un style complexe. Ce serait pas plus simple si on pouvait directement importer les couches d’un projet QGIS&nbsp;?</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExdzF3dWtlOGtjeHFmM2lheG05OGs2M2dmdmFsdnRjZ2t5am5tNnM1dSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/B9KKBuOIp4zqI7Cll0/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF: Clin d’œil"></p>
</figure>
</div>
</section>
<section id="tp---qgis-server-avec-lizmap" class="level2">
<h2 class="anchored" data-anchor-id="tp---qgis-server-avec-lizmap">TP - QGIS Server avec LizMap</h2>
<p><em>En cours de rédaction, revenez plus tard&nbsp;!</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/GradelerM">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://fr.linkedin.com/in/marie-gradeler">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>