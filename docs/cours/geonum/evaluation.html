<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Évaluation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../static/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cours" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cours</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cours">    
        <li>
    <a class="dropdown-item" href="../../cours/geonum/introduction.html">
 <span class="dropdown-text">GeoNum</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../cours/geonum/evaluation.html">Évaluation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/serveurs_carto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Serveurs cartographiques</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/openlayers_geoserver.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenLayers &amp; GeoServer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/enrichir_ma_carte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Enrichir ma carte en fonctionnalités</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours/geonum/evaluation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Évaluation</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#consignes" id="toc-consignes" class="nav-link active" data-scroll-target="#consignes">Consignes</a></li>
  <li><a href="#ma-carte-finale" id="toc-ma-carte-finale" class="nav-link" data-scroll-target="#ma-carte-finale">Ma carte finale</a></li>
  <li><a href="#ce-qui-est-demandé" id="toc-ce-qui-est-demandé" class="nav-link" data-scroll-target="#ce-qui-est-demandé">Ce qui est demandé</a>
  <ul class="collapse">
  <li><a href="#architecture-web" id="toc-architecture-web" class="nav-link" data-scroll-target="#architecture-web">Architecture web</a></li>
  <li><a href="#geoserver" id="toc-geoserver" class="nav-link" data-scroll-target="#geoserver">GeoServer</a></li>
  <li><a href="#openlayers---base" id="toc-openlayers---base" class="nav-link" data-scroll-target="#openlayers---base">OpenLayers - base</a></li>
  <li><a href="#menu-daffichage-des-couches" id="toc-menu-daffichage-des-couches" class="nav-link" data-scroll-target="#menu-daffichage-des-couches">Menu d’affichage des couches</a></li>
  <li><a href="#filtrage" id="toc-filtrage" class="nav-link" data-scroll-target="#filtrage">Filtrage</a></li>
  <li><a href="#requêtes" id="toc-requêtes" class="nav-link" data-scroll-target="#requêtes">Requêtes</a></li>
  <li><a href="#légende" id="toc-légende" class="nav-link" data-scroll-target="#légende">Légende</a></li>
  <li><a href="#échelle" id="toc-échelle" class="nav-link" data-scroll-target="#échelle">Échelle</a></li>
  </ul></li>
  <li><a href="#aller-plus-loin" id="toc-aller-plus-loin" class="nav-link" data-scroll-target="#aller-plus-loin">Aller plus loin</a>
  <ul class="collapse">
  <li><a href="#deals-et-son-contexte" id="toc-deals-et-son-contexte" class="nav-link" data-scroll-target="#deals-et-son-contexte">Deals et son contexte</a></li>
  <li><a href="#légende-pour-la-couche-wfs" id="toc-légende-pour-la-couche-wfs" class="nav-link" data-scroll-target="#légende-pour-la-couche-wfs">Légende pour la couche WFS</a></li>
  <li><a href="#affichage-dynamique-des-légendes" id="toc-affichage-dynamique-des-légendes" class="nav-link" data-scroll-target="#affichage-dynamique-des-légendes">Affichage dynamique des légendes</a></li>
  </ul></li>
  <li><a href="#à-rendre" id="toc-à-rendre" class="nav-link" data-scroll-target="#à-rendre">À rendre</a></li>
  <li><a href="#noubliez-pas-de-me-faire-un-retour" id="toc-noubliez-pas-de-me-faire-un-retour" class="nav-link" data-scroll-target="#noubliez-pas-de-me-faire-un-retour">N’oubliez pas de me faire un retour&nbsp;!</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Évaluation</h1>
<p class="subtitle lead">Modalités d’évaluation pour le cours GeoServer + OpenLayers, ou comment faire une super appli carto en binôme.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Les consignes suivantes s’adressent à la promo du M2 GeoNum 2024-2025.</p>
</div>
</div>
<section id="consignes" class="level2">
<h2 class="anchored" data-anchor-id="consignes">Consignes</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExN2lrb3g4NGV5Y3l2ejMxZXp3dnM1OHUzZmtiZHpqaHI1NW13anZ2ciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/NQ1YNmyVdaFH8KK6zu/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Miguel et Tulio ont peur des consignes"></p>
</figure>
</div>
<ul>
<li><p>Le rendu se fait seul ou en <strong>binôme</strong>, mais pas plus&nbsp;!</p></li>
<li><p>Le détail de tout ce que vous avez à m’envoyer se trouve dans la section <a href="#à-rendre">À rendre</a>.</p></li>
<li><p>Je vous demande quelques nouveaux éléments (normal, on ne va pas juste faire un copier-coller du TP) mais <strong>TOUT peut être fait en se basant sur le code que vous avez déjà</strong>. Si je vous demande de créer des “radio buttons” quelque part, souvenez-vous qu’on avait déjà des “radio buttons” pour d’autres fonctionnalités dans l’application. Il suffit d’appliquer la même méthode que celle qu’on a vue ensemble. Je vous ai mis quelques snippets de code là où je jugeais un coup de pouce nécessaire.</p></li>
<li><p>Vous pouvez utiliser Chat-GPT pour vous aiguiller mais pensez à bien retravailler le code et ne pas juste accepter ce qu’il vous donne à manger sans broncher. Si la structure de votre code est très différence de celle du TP et me paraît un peu trop “propre”, je le saurai 😉</p></li>
<li><p>Attention, il y a peu de texte. J’attends donc que vous preniez le temps de vous relire et que vous évitiez les fautes au maximum (et ce même si moi j’ai laissé des fautes de frappe dans mon TP, oui oui, faites ce que je dis pas ce que je fais). Chat-GPT peut aussi vous aider pour ça, évidemment.</p></li>
<li><p>Je prends en compte dans l’évaluation <strong>l’indentation du code ainsi que les commentaires</strong>. Faites en sorte de me donner un code propre et facile à lire&nbsp;!</p></li>
<li><p>Au sujet du nom des variables / constantes&nbsp;: je les préfère en camelCase mais comme j’ai fait un peu des deux dans le TP je ne vous pénaliserai pas si vous les écrivez en snake_case. Vous ne serez pas non plus pénalisés si vous déclarez des variables là où on pourrait déclarer une constante. <strong>Par contre, vous serez pénalisés si vous leur donnez des noms incompréhensibles</strong> et que j’ai besoin de déchiffrer tout votre code pour comprendre à quoi sert telle ou telle variable / constante&nbsp;!</p></li>
<li><p><strong>Je ne vous pénaliserai pas pour du code redondant.</strong> On n’en est pas à ce niveau d’optimisation. Au contraire, si je vois des étapes bien détaillées (et donc pas forcément très optimisées), je me dirais que vous avez plutôt fait ça vous-même et que vous avez bien compris votre code.</p></li>
<li><p>Vous verrez que je donne surtout des consignes pour vous guider sur l’ajout de HTML et JS, mais pas beaucoup en CSS. Vous êtes libres de styliser votre application comme vous le voulez, je vous demande simplement de <strong>ne pas vous en tenir au minimum vital</strong> et de faire un petit effort sur les visuels. Ça me montrera à la fois que vous n’en avez pas rien à faire de l’évaluation (ou alors que vous faites des efforts pour me faire croire le contraire) et ça fera du bien à ma rétine.</p></li>
<li><p>Faire tout ce qui se trouve dans la section <strong>ce qui est demandé</strong> ne suffit pas à avoir la note maximale, même si ça permet d’atteindre une très bonne note quand même&nbsp;! Si vous vous en sentez capable, poussez votre application plus loin en suivant la section “aller plus loin” et montrez moi qu’en plus d’adapter du code existant, vous arrivez à rajouter de nouveaux éléments.</p></li>
</ul>
</section>
<section id="ma-carte-finale" class="level2" data-link="Ma carte finale">
<h2 data-link="Ma carte finale" class="anchored" data-anchor-id="ma-carte-finale">Ma carte finale</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNXF2anZ3dXdpZXFmMXU3dzdud2w4MjMxdHU3Nzg1eWozenFvcnphYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/1mgpw7QGirOAmHurZY/200.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Miguel et Tulio lisent une carte"></p>
</figure>
</div>
<p>Pour vous guider, voici deux captures d’écran de ma carte à la fin de la préparation du TP. Notez que je n’ai pas ajouté mon nom, mais le votre devra apparaître quelque part&nbsp;!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/eval_result_3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Capture d’écran de ma carte, 1"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/eval_result_4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Capture d’écran de ma carte, 2"></p>
</figure>
</div>
<p>Vous verrez que certains éléments sont demandés dans la section <a href="#aller-plus-loin">Aller plus loin</a> et ne figureront donc pas nécessairement sur votre carte (mais vous en êtes tous capables, promis).</p>
<p>Allez, c’est à vous&nbsp;!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.tenor.com/m/aT7kl0dCEjcAAAAd/you-drank.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Tulio et Miguel, et encore une carte" width="400"></p>
</figure>
</div>
</section>
<section id="ce-qui-est-demandé" class="level2">
<h2 class="anchored" data-anchor-id="ce-qui-est-demandé">Ce qui est demandé</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour les instructions du rendu d’évaluation, toutes les couches de données ici proviennent bien du jeu de données Land Matrix Agri de l’évaluation et non pas du jeu Land Matrix Mines utilisé pour réaliser les TP.</p>
<p><strong>Les couches Land Matrix Mines ne seront pas prises en compte dans l’évaluation</strong> et n’ont même pas besoin de figurer dans votre GeoServer. Si vous le souhaitez, vous pouvez les supprimer.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Infos additionnelles
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Vous pouvez <strong>toujours</strong> aller plus loin que ce que je demande, vous ne serez jamais pénalisés pour avoir fait quelque chose de mieux que ce qui est demandé. Si je demande de créer un menu pour filtrer une couche selon deux paramètres, vous pouvez filtrer selon tous les paramètres. Si je demande des boutons radio mais que dans votre interface vous trouvez un menu de type dropdown plus logique, ça me va aussi.</p></li>
<li><p><strong>Vous pouvez styliser la carte comme vous le voulez, du moment que vous respectez les règles basiques de sémiologie graphique.</strong> Si le orange “Land Matrix” n’est pas votre truc, que vous préférez utiliser des triangles ou des pictogrammes plutôt que des points, pas de problème. Vous n’aimez pas les menus avec des coins arrondis&nbsp;? Vous voulez plutôt faire une application en “mode sombre” avec un fond noir et du texte blanc&nbsp;? Allez-y&nbsp;! L’important, c’est d’être fiers de votre rendu. C’est aussi plus intéressant pour moi de ne pas voir dix fois le même rendu mais des applications avec un peu de personnalité.</p></li>
</ul>
</div>
</div>
<section id="architecture-web" class="level3">
<h3 class="anchored" data-anchor-id="architecture-web">Architecture web</h3>
<p>Je ne vous demande rien de plus que ce qu’on a vu en TP. Vous n’êtes pas évalué sur Docker, vous pouvez donc reprendre l’architecture serveur créée ensemble. N’oubliez pas de m’envoyer vos fichiers <code>docker-compose.yml</code> et <code>Caddyfile</code>, surtout si vous les avez modifiés&nbsp;! Je vous ai mis la liste de tous les fichiers à m’envoyer en bas de la page.</p>
</section>
<section id="geoserver" class="level3">
<h3 class="anchored" data-anchor-id="geoserver">GeoServer</h3>
<p>Votre instance de GeoServer doit comprendre&nbsp;:</p>
<ul>
<li><p>Un espace de travail qui contient la donnée <a href="../../data/land_matrix/gpkg_land_matrix_agri.gpkg">Land Matrix Agri</a> (cliquez pour télécharger le jeu de données).</p></li>
<li><p>Toutes les couches du jeu de données publiées et requêtables dans la prévisualisation type “OpenLayers” de GeoServer.</p></li>
<li><p>Les couches de la donnée <code>deals</code> et <code>deals_by_country</code> doivent être stylisées. Vous n’êtes pas obligés de respecter l’exemple (voir <a href="#ma-carte-finale">Ma carte finale</a>) mais attention à la sémio quand même.</p></li>
</ul>
</section>
<section id="openlayers---base" class="level3">
<h3 class="anchored" data-anchor-id="openlayers---base">OpenLayers - base</h3>
<p>L’application doit contenir à minima&nbsp;:</p>
<ul>
<li><p>Une carte (qui prend ou non toute la taille de l’écran, à vous de décider).</p></li>
<li><p>Un fond de carte au choix.</p></li>
<li><p>La couche <code>deals</code> affichée en passant par un flux WMS (points simples).</p></li>
<li><p>La couche <code>deals_by_country</code> affichée en passant par un flux WMS (polygones simples).</p></li>
<li><p>La couche <code>deals_by_country_centroids</code> affichée en passant par un flux WFS (cercles proportionnels en fonction du nombre de deals, AVEC UNE TAILLE RAISONNABLE).</p></li>
<li><p>La couche <code>deals_by_country</code> doit être en-dessous des autres. Pour rappel, OpenLayers ajoute les couches sur la carte dans l’ordre dans lequel vous les ajoutez à votre objet <code>map</code>. La dernière couche est donc au-dessus des autres.</p></li>
<li><p>Un titre (où vous voulez sur la page).</p></li>
<li><p>Votre ou vos noms (où vous voulez sur la page).</p></li>
</ul>
<p>Vous pouvez strcturer le reste de votre page web comme vous le voulez tant qu’elle contient tous les éléments demandés ensuite.</p>
</section>
<section id="menu-daffichage-des-couches" class="level3">
<h3 class="anchored" data-anchor-id="menu-daffichage-des-couches">Menu d’affichage des couches</h3>
<p>Créez un menu d’affichage de couches qui doit contenir&nbsp;:</p>
<ul>
<li><p>Une “checkbox” qui permet d’afficher / masquer la couche <code>deals_by_country</code>.</p></li>
<li><p>Un groupe de deux “radio buttons” qui permet d’afficher SOIT la couche <code>deals</code> SOIT la couche <code>deals_by_country</code> (on ne doit pas pouvoir afficher les deux couches en même temps).</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>On ne demande pas d’afficher le tableau au format HTML généré par GeoServer mais bien de récupérer un objet au format JSON et de l’afficher dans le tableau que vous avez créé.</p>
</div>
</div>
</section>
<section id="filtrage" class="level3">
<h3 class="anchored" data-anchor-id="filtrage">Filtrage</h3>
<p>Créez un menu de filtrage avec des “radio buttons” qui permettent de filtrer la couche <code>deals</code> en fonction des types de production “Oil Palm”, “Soya Beans” et un autre au choix. N’oubliez pas l’option pour afficher tous les deals sans filtrage.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Il s’agit de la même chose que pour Land Matrix Mines mais au lieu de filtrer par “Gold”, “Silver”, etc. vous filtrez par des éléments comme “Oil Palm”, etc.</p>
</div>
</div>
</section>
<section id="requêtes" class="level3">
<h3 class="anchored" data-anchor-id="requêtes">Requêtes</h3>
<p>Créez où vous le souhaitez un tableau d’affichage des attributs&nbsp;:</p>
<ul>
<li><p>Le tableau comprend les colonnes “Deal ID”, “Creation date”, “Country” et “Crops”.</p></li>
<li><p>Cliquer sur un point de la couche <code>deals</code> remplit la ligne du tableau avec les attributs du point.</p></li>
<li><p>Cliquer ailleurs sur la carte vide la ligne du tableau (ou la remplit avec des “…”).</p></li>
</ul>
</section>
<section id="légende" class="level3">
<h3 class="anchored" data-anchor-id="légende">Légende</h3>
<p>Affichez la légende des deux couches WMS quelque part dans votre interface. Le code d’affichage de la légende était présent dans le document <code>.html</code> du tout premier TP. Je vous conseille de regarder ce code ou l’exemple officiel d’OpenLayers, et je vous guide un peu pour rédiger une version plus simple (parce que souvent, l’exemple officiel en fait un peu trop)&nbsp;:</p>
<ul>
<li><p>Vous devez créer quelque part dans votre interface une balise <code>&lt;img&gt;</code>. C’est elle qui contiendra l’image de la légende.</p></li>
<li><p>Vous avez besoin de récupérer la résolution de la carte pour pouvoir demander la légende à GeoServer. Si votre objet s’appelle <code>map</code>, c’est comme ça qu’il faut vous y prendre&nbsp;:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> resolution <span class="op">=</span> map<span class="op">.</span><span class="fu">getView</span>()<span class="op">.</span><span class="fu">getResolution</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Vous devez ensuite récupérer l’URL de l’image de la légende. C’est ce que <code>&lt;img&gt;</code> a besoin de lire pour afficher l’image dans l’interface. En imaginant que la source de ma couche s’appelle <code>source</code> et que j’ai bien stocké la résolution de ma carte dans <code>resolution</code> &nbsp;:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> url <span class="op">=</span> source<span class="op">.</span><span class="fu">getLegendUrl</span>(initResolution)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Pour définir la source <code>src</code> d’un tag <code>&lt;img&gt;</code> dont l’id est “legend”, on s’y prend de la manière suivante&nbsp;:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'legend'</span>)<span class="op">.</span><span class="at">src</span> <span class="op">=</span> url<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
<p>Avec ces éléments, il est facile d’afficher une légende sur sa carte&nbsp;!</p>
</section>
<section id="échelle" class="level3">
<h3 class="anchored" data-anchor-id="échelle">Échelle</h3>
<p>Affichez une échelle dans votre application&nbsp;! La solution est quelque part dans un des TPs donc je n’en dis pas plus ici.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Inutile de reproduire l’exemple officiel d’OpenLayers qui est super complexe, beaucoup trop pour notre carte. Vraiment, j’insiste, il y a la réponse dans un des TPs.</p>
</div>
</div>
</section>
</section>
<section id="aller-plus-loin" class="level2">
<h2 class="anchored" data-anchor-id="aller-plus-loin">Aller plus loin</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExb3A2Mm81d2gxeGtteXpwZXdya3F3OGw4N3Jha21hNG54bXQxNjJ5YSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/taU6RaT2Aaxt6/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Miguel avec une carte"></p>
</figure>
</div>
<p>Si vous avez tout fait jusqu’ici, bien joué, votre application contient le minimum attendu pour l’évaluation. Vous avez donc bien compris les bases de GeoServer et OpenLayers et vous avez tous les outils pour faire une carte basique.</p>
<p>Cependant, pour permettre de valoriser les étudiants qui sont suffisamment à l’aise pour ajouter de nouvelles features à leur carte et pas “seulement” adapter du code existant, vous ne serez pas notés sur la note maximale si vous n’ajoutez pas les éléments suivants.</p>
<section id="deals-et-son-contexte" class="level3">
<h3 class="anchored" data-anchor-id="deals-et-son-contexte">Deals et son contexte</h3>
<p>Masquez le menu de filtrage et d’affichage des attributs de <code>deals</code> lorsque la couche n’est pas affichée. Je vous donne un indice en vous montrant comment ajouter du style CSS à un élément HTML depuis du code JavaScript&nbsp;:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Je souhaite afficher mon élément "element"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'element'</span>)<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">'style'</span><span class="op">,</span> <span class="st">'visibility:visible'</span>)<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Je souhaite masquer mon élément "element"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'element'</span>)<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">'style'</span><span class="op">,</span> <span class="st">'visibility:hidden'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Bien sûr, vous pouvez jouer avec d’autres attributs que “visibility” si besoin.</p>
</section>
<section id="légende-pour-la-couche-wfs" class="level3">
<h3 class="anchored" data-anchor-id="légende-pour-la-couche-wfs">Légende pour la couche WFS</h3>
<p>Il manque une légende pour notre couche WFS. Comme on définit un style en JavaScript, on va devoir “dessiner” nous-même notre légende avec des cercles proportionnels. Comme c’est un exercice bonus je ne vais pas vous guider pas à pas, mais voici tout de même quelques éléments pour vous guider.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Écrire mon HTML
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vous devez commencer, comme toujours, par créer vos éléments en HTML. Ici, il vous faudra au minimum une <code>&lt;div&gt;</code> pour contenir tout le reste de votre légende, et à l’intérieur une nouvelle <code>&lt;div&gt;</code> par cercle que vous souhaitez afficher. Par exemple, j’ai choisi d’afficher quatre cercles.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dessiner un cercle
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Mes cercles sont en fait des <code>&lt;div&gt;</code> stylisées en CSS. Voici les propriétés importantes&nbsp;:</p>
<ul>
<li><p><code>display</code>&nbsp;: utilisez <code>block</code> ou <code>inline-block</code> si vous trouvez que votre cercle ne réagit pas aux autres propriétés CSS.</p></li>
<li><p><code>height</code> et <code>width</code>&nbsp;: si ces deux propriétés ne sont pas définies, elles sont nulles lorsque votre div est vide et vous ne la verrez donc pas. Il faut donner une hauteur et une largeur à notre futur cercle.</p></li>
<li><p><code>border-radius</code>&nbsp;: c’est la propriété CSS qui permet d’arrondir les coins d’une div. Un cercle, en fait, c’est une div avec des coins très arrondis.</p></li>
<li><p><code>background-color</code>&nbsp;: sans cette propriété, vous ne verrez pas votre cercle car il n’a pas de couleur.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
J’ai des cercles, comment changer leur taille ?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vous allez devoir vous baser sur la manière dont vous calculez le <code>rayon</code> de vos cercles proportionnels dans la légende OpenLayers (donc votre <code>Style</code>).</p>
<p>À partir de là, vous avez plusieurs possibilités&nbsp;:</p>
<ul>
<li><p>Soit vous appliquez vous-même la formule à des “paliers” pour trouver la taille correspondante. Par exemple, j’utilise la formule du rayon pour calculer la hauteur et la largeur (= diamètre) du cercle qui doit représenter 50 deals et je définis manuellement <code>height</code> et <code>width</code> en CSS.</p></li>
<li><p>Soit vous utilisez une formule en CSS pour ne pas avoir à faire le calcul vous-même pour chaque palier. Par exemple, pour mon palier 50 deals j’ai mis quelque part dans mon CSS cette propriété (attention, cette ligne de code correspond à MA formule <code>rayon</code> dans mon objet <code>Style</code>, pensez à bien utiliser la votre&nbsp;!)&nbsp;:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css code-with-copy"><code class="sourceCode css"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>height<span class="in">:</span> calc<span class="in">(</span>sqrt<span class="in">(</span>50<span class="in">)</span> <span class="op">*</span> 3px<span class="in">)</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Soit vous êtes super chaud et vous voulez automatiser le tout en JavaScript. Dans ce cas je vous laisse faire, vous savez déjà utiliser <code>setAttribute()</code>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="affichage-dynamique-des-légendes" class="level3">
<h3 class="anchored" data-anchor-id="affichage-dynamique-des-légendes">Affichage dynamique des légendes</h3>
<p>En utilisant les deux points précédents, faites en sorte que les légendes ne s’affichent que si la couche associée est affichée. Si la propriété CSS <code>visibility</code> ne donne pas des résultats suffisants, vous pouvez regarder la propriété <code>display</code>.</p>
</section>
</section>
<section id="à-rendre" class="level2">
<h2 class="anchored" data-anchor-id="à-rendre">À rendre</h2>
<p>Le travail d’équipe a payé, vous avez enfin une application à me rendre pour l’évaluation&nbsp;! Vous pouvez être fiers de vous.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExbGs2c3RzMmxuamJlN2hqdDAzdnBvaDk1MmxmaDN0a201bzRnb3J6bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/5zh4C2NKM1sGG9jro8/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Miguel et Tulio tope-la"></p>
</figure>
</div>
<p>Vous pouvez au choix push votre code sur GitHub ou GitLab (n’oubliez pas de retirer “dist” de <code>.gitignore</code> dans ce cas, j’ai besoin de voir le contenu de ce dossier), ou alors m’envoyer une archive <code>.zip</code> qui contient les fichiers et dossiers suivants&nbsp;:</p>
<ul>
<li><p><code>docker-compose.yml</code></p></li>
<li><p><code>Caddyfile</code></p></li>
<li><p><code>app/index.html</code> (+ tout autre fichier <code>.html</code> que vous avez créé)</p></li>
<li><p><code>app/style.css</code> (+ tout autre fichier <code>.css</code> que vous avez créé)</p></li>
<li><p><code>app/main.js</code> (+ tout autre fichier <code>.js</code> que vous avez créé)</p></li>
<li><p><code>app/dist</code></p></li>
<li><p><code>geoserver/opt/data</code></p></li>
<li><p><code>geoserver/opt/styles</code></p></li>
<li><p><code>geoserver/opt/workspaces</code></p></li>
</ul>
<p>Pour envoyer l’archive, vous pouvez utiliser la méthode de votre choix&nbsp;: Google Drive partagé, WeTransfer, FileTransfer avec l’université… peut importe, mais n’oubliez pas que je dois recevoir les éléments listés ci-dessus (ou le lien qui pointe vers ces éléments) à l’adresse <strong>marie.gradeler@gmail.com</strong> <strong>le 20 Janvier 2025 au plus tard</strong>&nbsp;!</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>S’il manque un seul de ces fichiers / dossiers, je pourrais ne pas pouvoir démarrer votre application. Vérifiez bien que vous avez tout envoyé&nbsp;!</p>
<p>Vérifier aussi que vous n’avez pas oublié de build votre application (cf.&nbsp;TP 2).</p>
</div>
</div>
</section>
<section id="noubliez-pas-de-me-faire-un-retour" class="level2">
<h2 class="anchored" data-anchor-id="noubliez-pas-de-me-faire-un-retour">N’oubliez pas de me faire un retour&nbsp;!</h2>
<p>Ce que vous avez suivi est une première version de ce cours, une version qui est donc perfectible. Je vous ai normalement fait passer un questionnaire de feedback à remplir pour m’aider à améliorer la forme et le contenu pour les années suivantes. Pensez à le remplir, ça m’aiderait beaucoup&nbsp;!</p>
<p>N’hésitez pas non plus à m’envoyer des questions liées à vos projets GeoNum, je serais ravie de vous aider. Promis, j’essaie de passer pendant la semaine de développement des projets.</p>
<p>Et pour ceux qui connaissent la source des GIF et qui trouvent qu’il manque quelque chose, non, je ne l’ai pas oublié, le voilà&nbsp;:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExdHd0bzZzczdpM2xpbnkxYXZpdGhnNGJkNjZ2Z29tYWttbWJpcmsyaSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ee8nTInXzCjCNVUNNv/giphy.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="GIF : Miguel qui joue de la guitare"></p>
</figure>
</div>
<p>Bonne continuation et à bientôt peut-être&nbsp;! Qui sait, le monde de la géomatique est petit 😁</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/GradelerM">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://fr.linkedin.com/in/marie-gradeler">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>